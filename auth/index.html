<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <title>ShotClock Â· Secure Auth Redirect</title>
    <link rel="stylesheet" href="../styles.css" />
    <style>
      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: radial-gradient(circle at top, #1a2b45, #0f1620 70%);
        color: #e6eef6;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 24px;
        text-align: center;
      }
      .card {
        background: rgba(15, 22, 32, 0.82);
        border: 1px solid rgba(77, 163, 255, 0.3);
        border-radius: 16px;
        padding: 32px 28px;
        max-width: 420px;
        box-shadow: 0 24px 48px rgba(9, 16, 28, 0.35);
        backdrop-filter: blur(20px);
      }
      h1 {
        margin-bottom: 12px;
        font-size: 1.9rem;
      }
      p {
        margin: 0 0 18px;
        color: #a9b8c8;
        line-height: 1.6;
      }
      .cta {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        background: linear-gradient(135deg, #4da3ff, #6b7bff);
        color: #ffffff;
        font-weight: 600;
        border-radius: 12px;
        padding: 14px 22px;
        text-decoration: none;
        transition: transform 0.15s ease, box-shadow 0.15s ease;
        box-shadow: 0 16px 28px rgba(77, 163, 255, 0.35);
      }
      .cta:hover,
      .cta:focus {
        transform: translateY(-1px);
        box-shadow: 0 20px 36px rgba(77, 163, 255, 0.4);
      }
      .support {
        margin-top: 24px;
        font-size: 0.95rem;
        color: #7f8fa7;
      }
      .support a {
        color: #4da3ff;
        text-decoration: none;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <main class="card">
      <h1>Check Your Email</h1>
      <p>
        We sent you a secure link to finish signing in. If the app did not open
        automatically, tap the button below to continue in ShotClock.
      </p>
      <p style="display: none" id="error-message">
        This link has expired. Please request a new password reset from the app.
      </p>
      <a id="app-link" class="cta" href="#">Continue in ShotClock</a>
      <div class="support">
        Need help? <a href="https://trackglp1.com/support.html">Contact support</a>
      </div>
    </main>
    <script>
      (function () {
        const hash = window.location.hash || "";
        const params = new URLSearchParams(hash.replace(/^#/, ""));
        const expiresAt = params.get("expires_at");
        const redirectHash = hash || "";
        const appLink = document.getElementById("app-link");
        const errorMessage = document.getElementById("error-message");

        if (appLink) {
          const deepLink = `shotclock://auth${redirectHash}`;
          appLink.href = deepLink;

          const isExpired =
            expiresAt && Date.now() / 1000 > Number.parseInt(expiresAt, 10);

          if (isExpired) {
            appLink.style.display = "none";
            errorMessage.style.display = "block";
            return;
          }

          const isMobile = /iPhone|iPad|iPod|Android/i.test(
            navigator.userAgent
          );
          if (isMobile) {
            window.location.replace(deepLink);
          }
        }
      })();
    </script>
  </body>
</html>
